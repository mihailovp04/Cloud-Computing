# Лабораторная работа №4. Облачное хранилище данных Amazon S3

**Выполнил:** Mihailov Piotr

**Группа:** I2302

---

## Цель работы

Целью данной работы было изучить сервис **Amazon S3**, научиться работать с публичными и приватными бакетами, загружать объекты через консоль и AWS CLI, включать версионирование, создавать правила жизненного цикла (Lifecycle) и разворачивать статический веб-сайт на основе S3.

После выполнения работы я научился:

* создавать и настраивать бакеты в AWS S3;
* управлять доступом к объектам через ACL и политики;
* работать с командами AWS CLI
* включать версионирование и настраивать Lifecycle-политику;
* публиковать статический сайт без использования серверов.

---

## Шаг 1. Подготовка

Сначала я определил регион — **eu-central-1 (Frankfurt)**. Далее создал на локальном компьютере папку `s3-lab`, в которой сделал следующую структуру:

```struct
s3-lab/
 ├── public/
 │   ├── avatars/
 │   │   ├── user1.jpg
 │   │   └── user2.jpg
 │   └── content/logo.png
 ├── private/
 │   └── logs/activity.csv
 └── README.md
```

Эти файлы потом использовались при загрузке в бакеты.

Затем я установил и настроил **AWS CLI**. Для этого выполнил команду:

```bash
aws configure
```

Ввел свои ключи доступа IAM-пользователя и указал регион `eu-central-1`. После этого проверил подключение командой:

```bash
aws s3 ls
```

Команда успешно вывела список бакетов, значит, всё настроено верно.

---

## Шаг 2. Создание бакетов

Я создал два бакета — публичный и приватный.

### Публичный бакет

* Имя: `cc-lab4-pub-k13`
* Регион: `eu-central-1`
* Ownership: `ACLs enabled`
* Галочку **Block all public access** я снял, чтобы разрешить публичный доступ.

После этого подтвердил предупреждение и нажал **Create bucket**.

### Приватный бакет

* Имя: `cc-lab4-priv-k13`
* Region: `eu-central-1`
* Ownership: `Bucket owner enforced`
* Опция **Block all public access** оставлена включенной.

Оба бакета успешно созданы.

**Чем отличаются два способа управления доступом к бакетам в S3?**

**Ответ:** Два способа управления доступом (ACL и Object Ownership Enforced) отличаются тем, что ACL позволяет управлять правами у отдельных файлов, а Ownership делает все объекты собственностью владельца бакета и требует использования IAM-политик. Второй вариант безопаснее, но я выбрал первый, чтобы наглядно видеть работу ACL.

**Что означает опция “Block all public access” и зачем нужна данная настройка?**

**Ответ:** Опция “Block all public access” запрещает публичный доступ к объектам. Если её отключить, можно сделать бакет и файлы доступными по ссылке.

---

## Шаг 3. Загрузка объектов через консоль

Открыл бакет `cc-lab4-pub-k13`, создал в нём папку `avatars`, нажал **Upload** и добавил файл `user1.jpg` из локальной директории.

В разделе **Permissions** выбрал `Grant public-read access`, чтобы файл стал публичным.

![image](https://imgur.com/G3RIBqs.png)

После загрузки проверил доступ по ссылке — изображение открылось в браузере.

![image](https://imgur.com/eXHIWwo.png)

**Чем отличается ключ (object key) от имени файла?**

**Ответ:** Ключ (object key) — это путь к объекту внутри бакета, например `avatars/user1.jpg`. Имя файла — это только название файла на локальном компьютере.

---

## Шаг 4. Загрузка через AWS CLI

Чтобы потренироваться работать через командную строку, я выполнил команды:

```bash
aws s3 cp s3-lab/public/avatars/user2.jpg s3://cc-lab4-pub-k13/avatars/user2.jpg --acl public-read
```

![image](https://imgur.com/tYWtjYE.png)

```bash
aws s3 cp s3-lab/public/content/logo.png s3://cc-lab4-pub-k13/content/logo.png --acl public-read
```

![image](https://imgur.com/pVGNpDd.png)

```bash
aws s3 cp s3-lab/private/logs/activity.csv s3://cc-lab4-priv-k13/logs/activity.csv
```

![image](https://imgur.com/9NQxUp5.png)

Файлы успешно загрузились. Первые два стали публичными, третий — приватным.

**В чём разница между командами aws s3 cp, mv и sync и для чего используется параметр флаг --acl public-read?** 

**Ответ:** Команда `cp` копирует, `mv` перемещает, а `sync` синхронизирует каталоги. Параметр `--acl public-read` делает файл общедоступным для чтения.

---

## Шаг 5. Проверка доступа

Я открыл ссылку на публичный файл:

```a
https://cc-lab4-pub-k13.s3.eu-central-1.amazonaws.com/avatars/user1.jpg
```

Изображение загрузилось успешно.

![image](https://imgur.com/eXHIWwo.png)

Затем попробовал открыть приватный файл:

```a
https://cc-lab4-priv-k13.s3.eu-central-1.amazonaws.com/logs/activity.csv
```

Браузер выдал ошибку *Access Denied*, что и требовалось — приватный бакет работает корректно.

![image](https://imgur.com/lbyzC1r.png)

---

## Шаг 6. Версионирование

Я открыл настройки бакета (**Properties → Bucket Versioning**) и включил опцию **Enable versioning**.

![image](https://imgur.com/QzfZFK4.png)

После этого изменил локально файл `logo.png` и снова загрузил его в тот же путь. В разделе **Show versions** появилось две версии одного файла.

![image](https://imgur.com/d6uxSAR.png)

**Что произойдёт, если выключить версионирование после его включения?**

**Ответ:** Если выключить версионирование, старые версии сохранятся, но новые больше не будут создаваться. Это нужно, чтобы не терять предыдущие версии при обновлении файлов.

---

## Шаг 7. Создание Lifecycle-правила

В приватном бакете открыл **Management → Lifecycle rules** и создал новое правило под названием `logs-archive`.

Настройки:

* Префикс: `logs/`
* Перевод в **Standard-IA** через 30 дней
* Перевод в **Glacier Deep Archive** через 365 дней
* Удаление через 1825 дней (5 лет)

![image](https://imgur.com/TuATrib.png)

Сохранил правило — оно появилось в списке активных.

**Что такое Storage Class в Amazon S3 и зачем они нужны?**

**Ответ:** Storage Class — это класс хранения данных, который определяет их стоимость и скорость доступа. Чем реже данные используются, тем дешевле можно выбрать класс (например, Glacier или Deep Archive).

---

## Шаг 8. Создание статического сайта

Создал новый бакет `cc-lab4-web-k13` для размещения сайта.

1. Снял галочку **Block all public access**.
2. Включил **Static website hosting → Enable**.
3. Указал индексный файл: `index.html`.

![image](https://imgur.com/rFWDGlS.png)

Сайт стал доступен по адресу:

```site
http://cc-lab4-web-k13.s3-website.eu-central-1.amazonaws.com
```

![image](https://imgur.com/DdtROye.png)

---

## Вывод

В ходе лабораторной работы я на практике изучил работу Amazon S3. Я создал два бакета — публичный и приватный, загрузил в них файлы через консоль и AWS CLI, включил версионирование, настроил Lifecycle-правило и запустил статический сайт. Также я понял разницу между типами доступа (ACL и Object Ownership) и научился работать с различными классами хранения.

В результате я освоил базовые навыки работы с облачным хранилищем AWS и теперь понимаю, как использовать S3 для хранения данных и публикации веб-контента.

---

## Список использованных источников

1. Документация Amazon S3 — [https://docs.aws.amazon.com/s3/](https://docs.aws.amazon.com/s3/)
2. AWS CLI Reference — [https://docs.aws.amazon.com/cli/latest/reference/s3/](https://docs.aws.amazon.com/cli/latest/reference/s3/)